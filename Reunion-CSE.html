<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CSE Training - Simulateur de R√©unions</title>
    <style>
        /* --- DESIGN SYSTEM --- */
        :root {
            --primary-dark: #0d47a1;   /* Bleu fonc√© prof */
            --primary: #1976d2;        /* Bleu standard */
            --primary-light: #bbdefb;  /* Bleu tr√®s clair */
            --accent: #00e5ff;         /* Cyan pour les points forts */
            --white: #ffffff;
            --bg: #f0f4f8;             /* Gris bleut√© fond */
            --text: #263238;
            --success: #4caf50;
            --danger: #f44336;
            --warning: #ff9800;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            background-color: var(--bg);
            margin: 0;
            padding: 0;
            color: var(--text);
            height: 100vh;
            display: flex;
            flex-direction: column;
        }

        /* --- PAGE MENU --- */
        .menu-container {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            padding: 20px;
            background: linear-gradient(135deg, var(--primary-dark) 0%, var(--primary) 100%);
        }

        .menu-card {
            background: var(--white);
            border-radius: 20px;
            padding: 40px;
            max-width: 600px;
            width: 100%;
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
            animation: fadeInUp 0.5s ease;
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .game-title {
            text-align: center;
            color: var(--primary-dark);
            font-size: 2rem;
            margin-bottom: 10px;
            font-weight: 800;
        }

        .game-subtitle {
            text-align: center;
            color: var(--primary);
            font-size: 1rem;
            margin-bottom: 30px;
            opacity: 0.8;
        }

        .rules-section {
            background: var(--bg);
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 30px;
        }

        .rules-title {
            color: var(--primary-dark);
            font-size: 1.2rem;
            margin-bottom: 15px;
            font-weight: 600;
        }

        .rule-item {
            margin-bottom: 15px;
            padding-left: 25px;
            position: relative;
            line-height: 1.6;
        }

        .rule-item::before {
            content: "‚ñ∏";
            position: absolute;
            left: 0;
            color: var(--primary);
            font-weight: bold;
        }

        .scoring-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-top: 20px;
        }

        .score-card {
            background: var(--white);
            border-radius: 8px;
            padding: 15px;
            text-align: center;
            border: 2px solid var(--primary-light);
        }

        .score-card-title {
            font-weight: bold;
            color: var(--primary);
            margin-bottom: 8px;
        }

        .score-threshold {
            font-size: 0.9rem;
            color: var(--text);
            margin: 5px 0;
        }

        .score-danger {
            color: var(--danger);
            font-weight: bold;
        }

        .score-warning {
            color: var(--warning);
        }

        .score-success {
            color: var(--success);
        }

        .btn-start {
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
            color: var(--white);
            border: none;
            padding: 18px 40px;
            border-radius: 30px;
            font-size: 1.1rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            text-transform: uppercase;
            letter-spacing: 1px;
            display: block;
            margin: 0 auto;
            box-shadow: 0 4px 15px rgba(25, 118, 210, 0.3);
        }

        .btn-start:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(25, 118, 210, 0.4);
        }

        .btn-start:active {
            transform: translateY(0);
        }

        /* --- HEADER (Jauges) --- */
        .app-header {
            background: linear-gradient(180deg, var(--primary-dark) 0%, var(--primary) 100%);
            color: var(--white);
            padding: 15px 20px;
            border-bottom-left-radius: 20px;
            border-bottom-right-radius: 20px;
            box-shadow: 0 4px 10px rgba(13, 71, 161, 0.3);
            z-index: 10;
            display: none; /* Cach√© sur le menu */
        }

        .stats-container {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
        }

        .stat-item {
            text-align: center;
            font-size: 0.85rem;
            opacity: 0.9;
        }

        .stat-value {
            font-size: 1.4rem;
            font-weight: 800;
            display: block;
        }

        .stat-value.danger {
            color: #ffcdd2;
            animation: pulse 1s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }

        /* Barre de progression */
        .progress-track {
            background-color: rgba(255,255,255,0.2);
            height: 6px;
            border-radius: 3px;
            margin-top: 5px;
            overflow: hidden;
        }
        .progress-fill {
            background-color: var(--accent);
            height: 100%;
            width: 0%; /* Sera chang√© par JS */
            transition: width 0.5s ease;
        }

        /* --- ZONE DE JEU (Scrollable) --- */
        .game-content {
            flex: 1;
            overflow-y: auto;
            padding: 20px;
            display: none; /* Cach√© sur le menu */
            flex-direction: column;
            gap: 15px;
        }

        .step-badge {
            align-self: center;
            background-color: var(--primary-light);
            color: var(--primary-dark);
            padding: 5px 12px;
            border-radius: 15px;
            font-size: 0.75rem;
            font-weight: bold;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 5px;
        }

        .card-dialogue {
            background-color: var(--white);
            border-radius: 16px;
            padding: 20px;
            box-shadow: 0 2px 15px rgba(0,0,0,0.05);
            border-left: 5px solid var(--primary);
        }

        .speaker {
            font-weight: bold;
            color: var(--primary);
            margin-bottom: 8px;
            font-size: 0.9rem;
        }

        .message {
            line-height: 1.6;
            font-size: 1rem;
        }

        /* --- FEEDBACK (Cach√© par d√©faut) --- */
        .feedback-card {
            background-color: #e3f2fd;
            border: 1px solid #90caf9;
            border-radius: 12px;
            padding: 15px;
            margin-top: 10px;
            font-size: 0.95rem;
            display: none;
            animation: slideUp 0.3s ease;
        }
        
        @keyframes slideUp {
            from { transform: translateY(20px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        /* --- BOUTONS (Fixes en bas) --- */
        .controls-area {
            padding: 20px;
            background-color: var(--white);
            border-top: 1px solid #e0e0e0;
            display: none; /* Cach√© sur le menu */
            flex-direction: column;
            gap: 10px;
        }

        .btn {
            background-color: var(--white);
            color: var(--primary);
            border: 2px solid var(--primary-light);
            padding: 14px;
            border-radius: 12px;
            font-size: 0.95rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            text-align: left;
            position: relative;
            min-height: 60px;
            display: flex;
            align-items: center;
        }

        .btn:hover {
            background-color: var(--primary-light);
            transform: translateX(5px);
        }

        .btn:active {
            transform: scale(0.98);
            background-color: var(--primary-light);
        }

        .btn-next {
            background-color: var(--primary);
            color: white;
            border: none;
            display: none; /* Cach√© tant qu'on n'a pas r√©pondu */
            text-align: center;
            justify-content: center;
        }

        /* --- √âCRAN DE FIN --- */
        .end-screen {
            text-align: center;
            padding: 30px;
        }

        .final-scores {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin: 30px 0;
        }

        .final-score-card {
            padding: 20px;
            border-radius: 12px;
            background: var(--white);
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .final-score-value {
            font-size: 2.5rem;
            font-weight: bold;
            margin: 10px 0;
        }

        .final-message {
            font-size: 1.1rem;
            line-height: 1.6;
            padding: 20px;
            background: var(--primary-light);
            border-radius: 12px;
            margin-bottom: 20px;
        }
    </style>
</head>
<body>

    <!-- PAGE MENU -->
    <div class="menu-container" id="menu-page">
        <div class="menu-card">
            <h1 class="game-title">üìã CSE Training</h1>
            <p class="game-subtitle">Simulateur de R√©unions du Comit√© Social et √âconomique</p>
            
            <div class="rules-section">
                <h2 class="rules-title">üìñ R√®gles du jeu</h2>
                
                <div class="rule-item">
                    <strong>Votre r√¥le :</strong> Vous incarnez le Secr√©taire du CSE, acteur cl√© des r√©unions avec l'employeur.
                </div>
                
                <div class="rule-item">
                    <strong>Votre mission :</strong> G√©rer 12 situations d√©licates en faisant les bons choix juridiques et relationnels.
                </div>
                
                <div class="rule-item">
                    <strong>Le d√©fi :</strong> Chaque d√©cision impacte deux jauges critiques : la <strong>L√©galit√©</strong> (conformit√© juridique) et le <strong>Climat Social</strong> (relations avec la direction et les salari√©s).
                </div>
                
                <div class="scoring-grid">
                    <div class="score-card">
                        <div class="score-card-title">‚öñÔ∏è L√âGALIT√â</div>
                        <div class="score-threshold score-success">80+ pts : Excellent</div>
                        <div class="score-threshold score-warning">40-79 pts : √Ä am√©liorer</div>
                        <div class="score-threshold score-danger">&lt; 40 pts : D√©lit d'entrave !</div>
                    </div>
                    
                    <div class="score-card">
                        <div class="score-card-title">ü§ù CLIMAT SOCIAL</div>
                        <div class="score-threshold score-success">60+ pts : Constructif</div>
                        <div class="score-threshold score-warning">30-59 pts : Tendu</div>
                        <div class="score-threshold score-danger">&lt; 30 pts : Gr√®ve/D√©missions !</div>
                    </div>
                </div>
                
                <div class="rule-item" style="margin-top: 20px;">
                    <strong>Objectif :</strong> Les jauges d√©marrent √† 50. √ätre juridiquement rigoureux peut tendre les relations sociales : √† vous de trouver le bon √©quilibre !
                </div>
            </div>
            
            <button class="btn-start" onclick="startGame()">Commencer la simulation</button>
        </div>
    </div>

    <!-- HEADER DU JEU -->
    <div class="app-header" id="game-header">
        <div class="stats-container">
            <div class="stat-item">
                <span class="stat-value" id="score-legal">50</span>
                L√©galit√©
            </div>
            <div class="stat-item">
                <span class="stat-value" id="score-social">50</span>
                Climat
            </div>
        </div>
        <div class="progress-track">
            <div class="progress-fill" id="progress-bar"></div>
        </div>
    </div>

    <!-- CONTENU DU JEU -->
    <div class="game-content" id="game-content">
        <div class="step-badge" id="step-title">√âtape 1/12</div>
        
        <div class="card-dialogue">
            <div class="speaker" id="speaker-name">Le Syst√®me</div>
            <div class="message" id="scenario-text">Chargement...</div>
        </div>

        <div class="feedback-card" id="feedback-box"></div>
    </div>

    <!-- ZONE DES BOUTONS -->
    <div class="controls-area" id="buttons-area"></div>

<script>
    // --- DONN√âES DU JEU ---
    const scenarios = [
        {
            title: "√âtape 1 : P√©riodicit√© & Obligation",
            speaker: "L'Employeur",
            text: "¬´ C'est un mois charg√©. Il n'y a pas de gros sujets urgents. Je propose d'annuler la r√©union de ce mois-ci, on se verra le mois prochain. √áa vous va ? ¬ª",
            choices: [
                { 
                    text: "Je propose plut√¥t une r√©union courte de 30 minutes pour respecter la loi.", 
                    correct: false, 
                    legal: -8, 
                    social: +5, 
                    feedback: "‚ö†Ô∏è Compromis risqu√©. La r√©union doit permettre de traiter vraiment les sujets, pas juste cocher une case." 
                },
                { 
                    text: "D'accord, si l'ordre du jour est vide, c'est inutile de se r√©unir.", 
                    correct: false, 
                    legal: -18, 
                    social: +3, 
                    feedback: "‚ùå Erreur grave ! Dans une entreprise de +300 salari√©s, la r√©union mensuelle est OBLIGATOIRE. L'annuler constitue un d√©lit d'entrave (Art. L2315-27)." 
                },
                { 
                    text: "Reportons √† la fin du mois, on aura plus de temps.", 
                    correct: false, 
                    legal: -12, 
                    social: 0, 
                    feedback: "‚ùå Non ! Reporter dans le m√™me mois reste probl√©matique car cela peut cr√©er des d√©calages r√©currents. La date habituelle doit √™tre respect√©e." 
                },
                { 
                    text: "Attention, vous avez l'obligation l√©gale de nous r√©unir chaque mois.", 
                    correct: true, 
                    legal: +5, 
                    social: -2, 
                    feedback: "‚úÖ Exact ! L'employeur doit respecter la p√©riodicit√© l√©gale. L'initiative de convoquer lui incombe." 
                }
            ]
        },
        {
            title: "√âtape 2 : Consultation des salari√©s",
            speaker: "Secr√©taire CSE",
            text: "Nous sommes √† 8 jours de la r√©union. Comment organise-t-on la collecte des r√©clamations individuelles et collectives des salari√©s ?",
            choices: [
                { 
                    text: "On d√©l√®gue la collecte aux managers de proximit√© pour gagner du temps.", 
                    correct: false, 
                    legal: -5, 
                    social: -12, 
                    feedback: "‚ùå Terrible id√©e ! Les managers font partie de la direction. Les salari√©s ne s'exprimeront pas librement." 
                },
                { 
                    text: "On attend qu'ils viennent nous voir dans le local CSE.", 
                    correct: false, 
                    legal: 0, 
                    social: -8, 
                    feedback: "‚ùå Trop passif ! Le r√¥le d'√©lu n√©cessite d'aller activement au contact pour capter les vrais probl√®mes terrain." 
                },
                { 
                    text: "On fait un tour des services et on envoie un mail de consultation.", 
                    correct: true, 
                    legal: +2, 
                    social: +8, 
                    feedback: "‚úÖ Parfait ! La collecte active et multicanale des r√©clamations est la base du r√¥le de d√©l√©gation du personnel." 
                },
                { 
                    text: "On met une bo√Æte √† suggestions anonyme et on la d√©pouille avant la r√©union.", 
                    correct: false, 
                    legal: 0, 
                    social: -3, 
                    feedback: "‚ö†Ô∏è Bien mais insuffisant. L'anonymat emp√™che le suivi individuel et le dialogue direct n√©cessaire." 
                }
            ]
        },
        {
            title: "√âtape 3 : R√©union Pr√©paratoire",
            speaker: "√âlu Suppl√©ant",
            text: "Pour notre r√©union pr√©paratoire de demain, est-ce qu'on invite le DRH pour gagner du temps et avoir ses √©clairages ?",
            choices: [
                { 
                    text: "Non, c'est un moment r√©serv√© uniquement aux √©lus.", 
                    correct: true, 
                    legal: +3, 
                    social: +4, 
                    feedback: "‚úÖ Tout √† fait ! C'est le moment de coordonner vos positions et pr√©parer vos arguments entre vous." 
                },
                { 
                    text: "On l'invite mais uniquement pour la partie questions techniques.", 
                    correct: false, 
                    legal: -5, 
                    social: -5, 
                    feedback: "‚ùå Non ! M√™me partiellement, sa pr√©sence biaise vos √©changes. Les questions techniques se posent en pl√©ni√®re." 
                },
                { 
                    text: "Oui, comme √ßa on discute directement avec lui des sujets.", 
                    correct: false, 
                    legal: -8, 
                    social: -8, 
                    feedback: "‚ùå Mauvaise id√©e ! La pr√©paratoire est un moment EXCLUSIF aux √©lus pour d√©finir leur strat√©gie sans pression." 
                },
                { 
                    text: "On fait deux parties : une entre nous, puis une avec lui.", 
                    correct: false, 
                    legal: -3, 
                    social: -3, 
                    feedback: "‚ö†Ô∏è Confus. La pr√©paratoire reste entre √©lus. Organisez plut√¥t une r√©union informelle s√©par√©e si besoin." 
                }
            ]
        },
        {
            title: "√âtape 4 : La Convocation",
            speaker: "L'Employeur",
            text: "Je vous envoie la convocation 7 jours avant. Par contre, vu l'ordre du jour limit√©, j'indique que la r√©union durera exactement 1 heure, pas plus. Il faut √™tre efficace !",
            choices: [
                { 
                    text: "Une heure c'est trop court, pr√©voyez au moins 3 heures syst√©matiquement.", 
                    correct: false, 
                    legal: -3, 
                    social: -10, 
                    feedback: "‚ö†Ô∏è Vous avez raison sur le principe mais imposer 3h syst√©matiques est aussi rigide. La dur√©e doit s'adapter aux sujets." 
                },
                { 
                    text: "OK pour 1h mais envoyez tous les documents pour qu'on pr√©pare efficacement.", 
                    correct: false, 
                    legal: -12, 
                    social: +4, 
                    feedback: "‚ùå Non ! M√™me avec les documents, accepter une limitation de dur√©e valide cette pratique ill√©gale d'entrave." 
                },
                { 
                    text: "Le d√©lai est bon mais vous ne pouvez pas limiter la dur√©e √† l'avance.", 
                    correct: true, 
                    legal: +5, 
                    social: -2, 
                    feedback: "‚úÖ Exact ! Le minutage excessif ou syst√©matique peut constituer un d√©lit d'entrave. De plus, le Pr√©sident ne peut cl√¥turer sans avoir √©tudi√© l'int√©gralit√© de l'ODJ." 
                },
                { 
                    text: "Parfait, 7 jours c'est bien et 1 heure suffira si on est organis√©s.", 
                    correct: false, 
                    legal: -15, 
                    social: +5, 
                    feedback: "‚ùå Attention ! Imposer un minutage strict √† l'avance peut constituer un d√©lit d'entrave. La dur√©e d√©pend des d√©bats n√©cessaires." 
                }
            ]
        },
        {
            title: "√âtape 5 : Modification de l'ODJ",
            speaker: "Le Pr√©sident",
            text: "Nous sommes √† 2 jours de la r√©union et je souhaite ajouter un point urgent √† l'ordre du jour concernant une restructuration. Je modifie l'ODJ et vous l'envoie.",
            choices: [
                { 
                    text: "D'accord si c'est vraiment urgent, allez-y.", 
                    correct: false, 
                    legal: -10, 
                    social: +4, 
                    feedback: "‚ùå Non ! Dans les 3 jours avant la r√©union, seul le CSE peut demander une modification de l'ODJ, pas l'employeur." 
                },
                { 
                    text: "Non, seul le CSE peut modifier l'ODJ dans ce d√©lai.", 
                    correct: true, 
                    legal: +5, 
                    social: -2, 
                    feedback: "‚úÖ Exact ! La jurisprudence permet au CSE de modifier l'ODJ : dans les 3 jours si urgent/justifi√©, √† l'unanimit√© en d√©but de r√©union, ou en cours si lien n√©cessaire avec les points initiaux (vote majoritaire)." 
                },
                { 
                    text: "On peut le rajouter mais uniquement si tous les √©lus sont d'accord par mail.", 
                    correct: false, 
                    legal: -5, 
                    social: 0, 
                    feedback: "‚ö†Ô∏è Partiel. L'unanimit√© est requise mais en d√©but de r√©union, pas par mail. Dans les 3 jours, c'est le CSE qui demande." 
                },
                { 
                    text: "Reportons la r√©union pour avoir le temps d'int√©grer ce point.", 
                    correct: false, 
                    legal: -8, 
                    social: +3, 
                    feedback: "‚ùå Reporter n'est pas la solution. Le pr√©sident ne peut pas imposer unilat√©ralement une modification tardive de l'ODJ." 
                }
            ]
        },
        {
            title: "√âtape 6 : Absence du Pr√©sident",
            speaker: "Le DRH",
            text: "Le Pr√©sident est absent pour raison m√©dicale. Je n'ai pas de d√©l√©gation de pouvoir mais je connais tous les dossiers. Je propose qu'on tienne quand m√™me la r√©union pour ne pas perdre de temps.",
            choices: [
                { 
                    text: "D'accord, vous connaissez les dossiers, pr√©sidez exceptionnellement.", 
                    correct: false, 
                    legal: -15, 
                    social: +4, 
                    feedback: "‚ùå Ill√©gal ! Sans d√©l√©gation de pouvoir formelle, le DRH ne peut pas pr√©sider. La r√©union serait nulle." 
                },
                { 
                    text: "On fait une r√©union informelle pour pr√©parer la vraie r√©union.", 
                    correct: false, 
                    legal: -8, 
                    social: +3, 
                    feedback: "‚ö†Ô∏è Confusion dangereuse. Une 'fausse' r√©union cr√©e de l'ambigu√Øt√© sur les d√©cisions prises." 
                },
                { 
                    text: "Non, impossible sans pr√©sidence valable, la r√©union serait annul√©e.", 
                    correct: true, 
                    legal: +4, 
                    social: -4, 
                    feedback: "‚úÖ Exact ! Une r√©union pl√©ni√®re sans pr√©sidence valable est nulle. Toutes les d√©cisions pourraient √™tre annul√©es en justice." 
                },
                { 
                    text: "Le secr√©taire du CSE peut pr√©sider en l'absence du pr√©sident.", 
                    correct: false, 
                    legal: -18, 
                    social: -4, 
                    feedback: "‚ùå Faux ! Le secr√©taire CSE ne peut JAMAIS pr√©sider la r√©union, c'est une confusion des r√¥les." 
                }
            ]
        },
        {
            title: "√âtape 7 : Vote sur D√©m√©nagement",
            speaker: "Pr√©sident",
            text: "Nous passons au vote sur le projet de d√©m√©nagement de l'entreprise √† 50km, ce qui impactera tous les salari√©s. C'est une modification importante des conditions de travail. Qui vote ?",
            choices: [
                { 
                    text: "Tous les pr√©sents : titulaires, suppl√©ants et repr√©sentants syndicaux.", 
                    correct: false, 
                    legal: -15, 
                    social: +3, 
                    feedback: "‚ùå Grave erreur ! Seuls les titulaires (ou suppl√©ants rempla√ßant un absent) votent. Les RS n'ont jamais le droit de vote." 
                },
                { 
                    text: "Les titulaires pr√©sents et les suppl√©ants rempla√ßant un titulaire absent.", 
                    correct: true, 
                    legal: +4, 
                    social: 0, 
                    feedback: "‚úÖ Parfait ! C'est la r√®gle : titulaires pr√©sents + suppl√©ants rempla√ßant effectivement un titulaire absent." 
                },
                { 
                    text: "Uniquement les titulaires, les suppl√©ants ne votent jamais.", 
                    correct: false, 
                    legal: -8, 
                    social: -5, 
                    feedback: "‚ùå Incomplet. Les suppl√©ants votent s'ils remplacent un titulaire absent, c'est leur r√¥le." 
                },
                { 
                    text: "Les titulaires plus le pr√©sident pour d√©partager si √©galit√©.", 
                    correct: false, 
                    legal: -12, 
                    social: -3, 
                    feedback: "‚ùå Non ! Le pr√©sident ne vote JAMAIS au CSE, m√™me pour d√©partager. Il n'est pas membre √©lu." 
                }
            ]
        },
        {
            title: "√âtape 8 : Cl√¥ture forc√©e",
            speaker: "L'Employeur",
            text: "Il est 18h, on a trait√© 13 points sur les 18 de l'ordre du jour. J'ai un rendez-vous important, je l√®ve la s√©ance. On verra les 5 derniers points le mois prochain.",
            choices: [
                { 
                    text: "Non, vous devez √©tudier l'ODJ complet ou demander au CSE de reporter.", 
                    correct: true, 
                    legal: +4, 
                    social: -4, 
                    feedback: "‚úÖ Exact ! L'employeur doit √©tudier l'int√©gralit√© de l'ODJ. Une cl√¥ture unilat√©rale sans accord du CSE est irr√©guli√®re." 
                },
                { 
                    text: "D'accord, on reprendra ces points en priorit√© le mois prochain.", 
                    correct: false, 
                    legal: -10, 
                    social: +4, 
                    feedback: "‚ùå Non ! Accepter valide cette pratique ill√©gale. L'employeur ne peut pas d√©cider seul de tronquer l'ODJ." 
                },
                { 
                    text: "OK mais envoyez-nous vos positions √©crites sur les points restants.", 
                    correct: false, 
                    legal: -10, 
                    social: +3, 
                    feedback: "‚ùå Insuffisant. Le d√©bat oral en s√©ance est essentiel. Des positions √©crites ne remplacent pas la d√©lib√©ration." 
                },
                { 
                    text: "On vote pour savoir si on continue ou si on reporte.", 
                    correct: false, 
                    legal: -5, 
                    social: 0, 
                    feedback: "‚ö†Ô∏è Mieux mais incomplet. Le CSE peut accepter de reporter, mais l'employeur ne peut pas l'imposer unilat√©ralement." 
                }
            ]
        },
        {
            title: "√âtape 9 : R√©daction du PV",
            speaker: "DRH",
            text: "Pour vous aider et gagner du temps, j'ai pr√©par√© le PV de la r√©union. Il est tr√®s complet, vous n'avez qu'√† le valider.",
            choices: [
                { 
                    text: "Je peux m'en inspirer mais je r√©dige ma propre version.", 
                    correct: false, 
                    legal: -3, 
                    social: +3, 
                    feedback: "‚ö†Ô∏è Acceptable mais m√©fiance : v√©rifiez qu'il n'oriente pas le contenu. Mieux vaut partir de vos notes." 
                },
                { 
                    text: "Merci, √ßa m'arrange, je le signe tout de suite.", 
                    correct: false, 
                    legal: -12, 
                    social: +4, 
                    feedback: "‚ùå Pi√®ge ! La r√©daction du PV est la pr√©rogative EXCLUSIVE du secr√©taire. Un PV r√©dig√© par l'employeur n'a aucune valeur." 
                },
                { 
                    text: "On le co-r√©dige ensemble pour √™tre s√ªr d'√™tre d'accord.", 
                    correct: false, 
                    legal: -8, 
                    social: +3, 
                    feedback: "‚ùå Non ! Le PV est la vision du secr√©taire. L'employeur pourra contester apr√®s mais pas co-r√©diger." 
                },
                { 
                    text: "Non, c'est mon r√¥le l√©gal de secr√©taire de le r√©diger.", 
                    correct: true, 
                    legal: +4, 
                    social: -2, 
                    feedback: "‚úÖ Bravo ! Vous prot√©gez votre pr√©rogative essentielle. Le PV est VOTRE responsabilit√© exclusive." 
                }
            ]
        },
        {
            title: "√âtape 10 : Modification du PV",
            speaker: "L'Employeur",
            text: "J'ai lu votre projet de PV. Mes propos sur le projet de modification des services y sont trop d√©taill√©s. Retirez ce passage, ce n'est pas encore officiel.",
            choices: [
                { 
                    text: "Je reformule de fa√ßon plus vague mais je garde l'id√©e.", 
                    correct: false, 
                    legal: -8, 
                    social: +4, 
                    feedback: "‚ùå D√©naturer les propos est aussi grave que les supprimer. Le PV doit √™tre exact, pas diplomatique." 
                },
                { 
                    text: "Je mets ce passage en annexe confidentielle.", 
                    correct: false, 
                    legal: -3, 
                    social: 0, 
                    feedback: "‚ö†Ô∏è Compromis bancal. Le PV forme un tout. Les annexes ne changent pas le fait que c'√©tait dit en s√©ance." 
                },
                { 
                    text: "D'accord, je retire pour pr√©server la confidentialit√©.", 
                    correct: false, 
                    legal: -10, 
                    social: +5, 
                    feedback: "‚ùå Non ! Le PV doit refl√©ter FID√àLEMENT les d√©bats. Censurer apr√®s coup est une falsification." 
                },
                { 
                    text: "Je refuse, ces propos ont √©t√© tenus en s√©ance.", 
                    correct: true, 
                    legal: +4, 
                    social: -4, 
                    feedback: "‚úÖ Courageux et juste ! Le PV est la m√©moire juridique. Cette information n'est pas automatiquement soumise au secret. La confidentialit√© doit √™tre d√©cr√©t√©e par le Pr√©sident AU MOMENT o√π il communique l'information, pas apr√®s." 
                }
            ]
        },
        {
            title: "√âtape 11 : Approbation du PV",
            speaker: "Secr√©taire CSE",
            text: "Mon PV est pr√™t depuis 5 jours. Quand et comment le fait-on approuver officiellement ?",
            choices: [
                { 
                    text: "On organise un vote √©lectronique cette semaine.", 
                    correct: false, 
                    legal: -5, 
                    social: +3, 
                    feedback: "‚ö†Ô∏è Possible si votre r√®glement int√©rieur le pr√©voit, sinon c'est en s√©ance pl√©ni√®re uniquement." 
                },
                { 
                    text: "Je le fais signer par le pr√©sident imm√©diatement.", 
                    correct: false, 
                    legal: -10, 
                    social: -3, 
                    feedback: "‚ùå Le pr√©sident ne valide pas seul. C'est l'instance qui approuve collectivement." 
                },
                { 
                    text: "On vote l'approbation au d√©but de la prochaine r√©union.", 
                    correct: true, 
                    legal: +3, 
                    social: +3, 
                    feedback: "‚úÖ C'est la proc√©dure standard. Premier point de l'ODJ suivant : approbation du PV pr√©c√©dent." 
                },
                { 
                    text: "J'envoie un mail pour approbation tacite sous 48h.", 
                    correct: false, 
                    legal: -8, 
                    social: 0, 
                    feedback: "‚ùå Non, l'approbation tacite n'existe pas pour les PV de CSE. Il faut un vote formel." 
                }
            ]
        },
        {
            title: "√âtape 12 : Communication du PV",
            speaker: "Salari√©",
            text: "Le PV est approuv√© depuis hier. O√π et quand peut-on le consulter ? On veut savoir ce qui s'est dit sur les primes.",
            choices: [
                { 
                    text: "Il faut demander l'autorisation du pr√©sident pour y acc√©der.", 
                    correct: false, 
                    legal: -10, 
                    social: -8, 
                    feedback: "‚ùå Absolument pas ! L'acc√®s au PV est un droit des salari√©s, pas une faveur de la direction." 
                },
                { 
                    text: "Je l'envoie uniquement aux adh√©rents syndicaux.", 
                    correct: false, 
                    legal: -5, 
                    social: -8, 
                    feedback: "‚ùå Discriminatoire ! Le CSE repr√©sente TOUS les salari√©s, syndiqu√©s ou non." 
                },
                { 
                    text: "D√©sol√©, c'est confidentiel, je ne peux que vous r√©sumer oralement.", 
                    correct: false, 
                    legal: -8, 
                    social: -12, 
                    feedback: "‚ùå Faux ! Sauf donn√©es sensibles sp√©cifiques, le PV est un document public pour les salari√©s." 
                },
                { 
                    text: "Je l'affiche sur les panneaux CSE et l'intranet dans les 48h.", 
                    correct: true, 
                    legal: +2, 
                    social: +9, 
                    feedback: "‚úÖ Parfait ! Transparence totale. Le PV approuv√© (et √©pur√© des donn√©es sensibles) doit √™tre accessible √† tous." 
                }
            ]
        }
    ];

    // --- VARIABLES GLOBALES ---
    let currentStep = 0;
    let stats = { legal: 50, social: 50 };
    let correctCount = 0;
    let wrongCount = 0;
    let hasAnswered = false;

    // --- FONCTIONS ---
    function startGame() {
        // Cacher le menu, afficher le jeu
        document.getElementById('menu-page').style.display = 'none';
        document.getElementById('game-header').style.display = 'block';
        document.getElementById('game-content').style.display = 'flex';
        document.getElementById('buttons-area').style.display = 'flex';
        
        // Charger la premi√®re √©tape
        loadStep(0);
    }

    function loadStep(index) {
        hasAnswered = false;
        
        // Mise √† jour de la barre de progression
        const progressPercent = ((index) / scenarios.length) * 100;
        document.getElementById('progress-bar').style.width = progressPercent + '%';

        if (index >= scenarios.length) {
            showEndScreen();
            return;
        }

        const step = scenarios[index];
        
        // Mise √† jour textes avec le titre complet de l'√©tape
        document.getElementById('step-title').innerText = step.title;
        document.getElementById('speaker-name').innerText = step.speaker;
        document.getElementById('scenario-text').innerText = step.text;
        
        // Reset Feedback
        const feedbackBox = document.getElementById('feedback-box');
        feedbackBox.style.display = 'none';
        feedbackBox.innerHTML = '';

        // G√©n√©ration Boutons
        const btnsArea = document.getElementById('buttons-area');
        btnsArea.innerHTML = ''; // Clean

        step.choices.forEach((choice, idx) => {
            const btn = document.createElement('div');
            btn.className = 'btn';
            btn.innerHTML = `${choice.text}`;
            btn.onclick = () => {
                if (!hasAnswered) {
                    handleChoice(choice);
                }
            };
            btnsArea.appendChild(btn);
        });
    }

    function handleChoice(choice) {
        hasAnswered = true;
        
        // Comptage bonnes/mauvaises r√©ponses
        if (choice.correct) {
            correctCount++;
        } else {
            wrongCount++;
        }
        
        // Mise √† jour stats
        stats.legal += choice.legal;
        stats.social += choice.social;
        
        // Bornes 0-100
        stats.legal = Math.max(0, Math.min(100, stats.legal));
        stats.social = Math.max(0, Math.min(100, stats.social));

        // Mise √† jour affichage avec animation si critique
        const legalElement = document.getElementById('score-legal');
        const socialElement = document.getElementById('score-social');
        
        legalElement.innerText = stats.legal;
        socialElement.innerText = stats.social;
        
        // Ajouter classe danger si < 40
        if (stats.legal < 40) {
            legalElement.classList.add('danger');
        } else {
            legalElement.classList.remove('danger');
        }
        
        if (stats.social < 40) {
            socialElement.classList.add('danger');
        } else {
            socialElement.classList.remove('danger');
        }

        // Afficher Feedback
        const feedbackBox = document.getElementById('feedback-box');
        feedbackBox.innerHTML = choice.feedback;
        feedbackBox.style.display = 'block';
        
        // Colorer selon le r√©sultat
        if (choice.correct) {
            feedbackBox.style.borderColor = 'var(--success)';
            feedbackBox.style.backgroundColor = '#e8f5e9';
        } else {
            feedbackBox.style.borderColor = 'var(--danger)';
            feedbackBox.style.backgroundColor = '#ffebee';
        }

        // Remplacer les boutons par "Suivant"
        const btnsArea = document.getElementById('buttons-area');
        btnsArea.innerHTML = '';
        
        const nextBtn = document.createElement('div');
        nextBtn.className = 'btn btn-next';
        nextBtn.style.display = 'flex';
        nextBtn.innerText = (currentStep + 1 < scenarios.length) ? '‚Üí √âtape Suivante' : 'üèÅ Voir le bilan';
        nextBtn.onclick = () => {
            currentStep++;
            loadStep(currentStep);
        };
        btnsArea.appendChild(nextBtn);
    }

    function showEndScreen() {
        document.getElementById('progress-bar').style.width = '100%';
        
        // Pr√©parer le message final
        let finalTitle = "üèÅ Simulation Termin√©e";
        let legalStatus = "";
        let socialStatus = "";
        let globalMessage = "";
        
        // Grade bas√© sur le nombre de bonnes r√©ponses
        const totalQuestions = scenarios.length;
        const scoreRatio = correctCount / totalQuestions;
        let gradeLabel = "";
        let gradeColor = "";
        
        if (scoreRatio >= 0.9) {
            gradeLabel = "A ‚Äî Ma√Ætre Jedi du CSE";
            gradeColor = "#4caf50";
        } else if (scoreRatio >= 0.75) {
            gradeLabel = "B ‚Äî Padawan prometteur";
            gradeColor = "#8bc34a";
        } else if (scoreRatio >= 0.58) {
            gradeLabel = "C ‚Äî Peut mieux faire (le prof l'a dit)";
            gradeColor = "#ff9800";
        } else if (scoreRatio >= 0.42) {
            gradeLabel = "D ‚Äî L'inspecteur du travail vous surveille";
            gradeColor = "#ff5722";
        } else {
            gradeLabel = "E ‚Äî Seul Hiiato peut vous venir en aide !";
            gradeColor = "#f44336";
        }
        
        // Analyse L√©galit√©
        if (stats.legal >= 80) {
            legalStatus = "‚úÖ Excellente ma√Ætrise juridique";
        } else if (stats.legal >= 60) {
            legalStatus = "üëç Bonne conformit√© juridique";
        } else if (stats.legal >= 40) {
            legalStatus = "‚ö†Ô∏è Conformit√© fragile, des lacunes √† combler";
        } else {
            legalStatus = "üö® ALERTE : Risque de d√©lit d'entrave !";
        }
        
        // Analyse Climat Social
        if (stats.social >= 60) {
            socialStatus = "‚úÖ Climat social constructif";
        } else if (stats.social >= 45) {
            socialStatus = "‚ö†Ô∏è Climat social tendu mais g√©rable";
        } else if (stats.social >= 30) {
            socialStatus = "üò§ Relations sociales d√©grad√©es";
        } else {
            socialStatus = "üö® DANGER : Risque de gr√®ve/d√©missions !";
        }
        
        // Message global bas√© sur le combo score + erreurs
        if (correctCount >= 11) {
            globalMessage = "üèÜ EXCELLENT MANDAT ! M√™me l'inspecteur du travail vous applaudirait (et croyez-nous, c'est rare). Vous ma√Ætrisez parfaitement l'√©quilibre entre rigueur juridique et dialogue social. Le Code du travail n'a plus de secrets pour vous‚Ä¶ ou presque. üòè";
        } else if (correctCount >= 9) {
            globalMessage = "üëç Bon mandat ! Quelques h√©sitations, mais rien qui justifie une gr√®ve‚Ä¶ pour l'instant. Vous avez les bases solides, il reste √† peaufiner les r√©flexes. Un ou deux caf√©s avec le Code du travail et vous serez au top. ‚òï";
        } else if (correctCount >= 7) {
            globalMessage = "‚ö†Ô∏è Disons que votre bo√Æte mail risque de recevoir quelques courriers recommand√©süìö";
        } else if (correctCount >= 5) {
            globalMessage = "üö® ML'avocat de l'entreprise se frotte les mains, et les salari√©s pr√©parent leurs pancartes. √Ä ce rythme, votre prochain PV sera r√©dig√© par le tribunal ! üÜò";
        } else {
            globalMessage = "üí• Houston, on a un probl√®me ! Si c'√©tait un vrai CSE, l'inspection du travail camperait dans le hall d'entr√©e et les syndicats auraient d√©j√† command√© les gilets jaunes. Bonne nouvelle : c'est un jeu.üéì";
        }
        
        // Affichage
        document.getElementById('step-title').style.display = 'none';
        document.getElementById('speaker-name').innerText = finalTitle;
        
        document.getElementById('scenario-text').innerHTML = `
            <div class="end-screen">
                <div style="background: ${gradeColor}15; border: 2px solid ${gradeColor}; border-radius: 12px; padding: 15px; margin-bottom: 20px; text-align: center;">
                    <div style="font-size: 0.9rem; color: #666; margin-bottom: 5px;">NOTE GLOBALE</div>
                    <div style="font-size: 2rem; font-weight: 800; color: ${gradeColor};">${gradeLabel}</div>
                    <div style="font-size: 1.1rem; margin-top: 8px; color: var(--text);">
                        ‚úÖ ${correctCount} bonne${correctCount > 1 ? 's' : ''} r√©ponse${correctCount > 1 ? 's' : ''} 
                        &nbsp;¬∑&nbsp; 
                        ‚ùå ${wrongCount} erreur${wrongCount > 1 ? 's' : ''} 
                        &nbsp;sur ${totalQuestions} questions
                    </div>
                </div>
                <div class="final-scores">
                    <div class="final-score-card">
                        <div>‚öñÔ∏è L√âGALIT√â</div>
                        <div class="final-score-value" style="color: ${stats.legal >= 60 ? 'var(--success)' : stats.legal >= 40 ? 'var(--warning)' : 'var(--danger)'}">
                            ${stats.legal}/100
                        </div>
                        <div>${legalStatus}</div>
                    </div>
                    <div class="final-score-card">
                        <div>ü§ù CLIMAT SOCIAL</div>
                        <div class="final-score-value" style="color: ${stats.social >= 50 ? 'var(--success)' : stats.social >= 30 ? 'var(--warning)' : 'var(--danger)'}">
                            ${stats.social}/100
                        </div>
                        <div>${socialStatus}</div>
                    </div>
                </div>
                <div class="final-message">
                    ${globalMessage}
                </div>
            </div>
        `;
        
        document.getElementById('feedback-box').style.display = 'none';
        document.getElementById('buttons-area').innerHTML = `
            <div class="btn btn-next" style="display: flex" onclick="location.reload()">
                üîÑ Recommencer la simulation
            </div>
        `;
    }

    // Initialisation (afficher le menu au chargement)
    // Le menu est d√©j√† visible par d√©faut dans le HTML
</script>

</body>
</html>
